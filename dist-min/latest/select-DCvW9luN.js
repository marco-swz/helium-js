import{h as t,a as e}from"./utils-CE1sATTG.js";import"./popover-CJR4GMWa.js";const i=new CSSStyleSheet;i.replaceSync(':host {\n    --he-select-backgroundColor: whitesmoke;\n    --he-select-borderColor: lightgrey;\n    --he-select-borderWidth: 1px;\n    --he-select-borderRadius: 3px;\n    --he-select-hover-borderColor: grey;\n    --he-select-color: black;\n    --he-select-padding: 0.3rem 0.4rem;\n    --he-select-popover-borderRadius: 4px;\n    --he-select-option-hover-backgroundColor: whitesmoke;\n    --he-select-option-selected-backgroundColor: whitesmoke;\n    --he-select-after-margin: auto 4px auto auto;\n    --he-select-after-content: "â–¼";\n    --he-select-after-fontSize: 10px;\n    --he-select-disabled-color: hsl(from var(--he-select-color) h s calc(l + 50));\n\n    height: 1.6rem;\n    font-size: 14px;\n    min-width: 150px;\n    width: 150px;\n    display: inline-block;\n}\n\n:host([disabled]) {\n    pointer-events: none;\n    color: var(--he-select-disabled-color);\n}\n\n:host([variant="underline"]) {\n    #inp {\n        border-top: 0;\n        border-left: 0;\n        border-right: 0;\n        border-radius: 0;\n    }\n}\n\n#cont-button {\n    height: inherit;\n    width: inherit;\n}\n\n#inp {\n    position: relative;\n    background-color: var(--he-select-backgroundColor);\n    border-width: var(--he-select-borderWidth);\n    border-radius: var(--he-select-borderRadius);\n    border-color: var(--he-select-borderColor);\n    border-style: solid;\n    font-size: inherit;\n    width: 100%;\n    height: inherit;\n    min-width: inherit;\n    padding: var(--he-select-padding);\n    outline: none;\n    text-align: left;\n    padding-right: 25px;\n    text-wrap: nowrap;\n    color: inherit;\n    overflow: hidden;\n    text-overflow: ellipsis;\n}\n\n#inp:hover {\n    transition:\n        border-color 0.2s;\n    cursor: pointer;\n    border-color: var(--he-select-hover-borderColor);\n}\n\n#inp::after {\n    content: var(--he-select-after-content);\n    position: absolute;\n    font-size: var(--he-select-after-fontSize);\n    width: fit-content;\n    height: fit-content;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    margin: var(--he-select-after-margin);\n}\n\n#popover {\n    border-radius: var(--he-select-popover-borderRadius);\n}\n\n#cont-options {\n    display: flex;\n    flex-direction: column;\n    background-color: var(--he-select-clr-bg, white);\n    max-height: 300px;\n    overflow: auto;\n    overscroll-behavior: contain;\n    user-select: none;\n}\n\n#cont-options option {\n    padding: 5px 10px;\n    border-radius: 3px;\n    text-align: left;\n    width: 100%;\n    width: -moz-available;          /* WebKit-based browsers will ignore this. */\n    width: -webkit-fill-available;  /* Mozilla-based browsers will ignore this. */\n    width: fill-available;\n\n    &::after {\n        font-family: "Font Awesome 5 Pro";\n        content: "\\f00c";\n        font-weight: 600;\n        color: transparent;\n        margin-left: 6px;\n        float: right;\n    }\n}\n\n#cont-options option[selected] {\n    &::after {\n        color: steelblue;\n    }\n}\n\n#cont-options:not(:hover) option[highlighted] {\n    background-color: var(--he-select-option-selected-backgroundColor);\n}\n\n#cont-options option:hover:not(:disabled) {\n    background-color: var(--he-select-option-hover-backgroundColor);\n    cursor: pointer;\n}\n\n#filter {\n    width: 100%;\n    width: -moz-available;          /* WebKit-based browsers will ignore this. */\n    width: -webkit-fill-available;  /* Mozilla-based browsers will ignore this. */\n    width: fill-available;\n    margin: 3px;\n}\n\n:host([filter="inline"]) {\n    #filter {\n        --he-input-padding: var(--he-select-padding);\n        background-color: var(--he-select-backgroundColor);\n        border-width: var(--he-select-borderWidth);\n        border-radius: var(--he-select-borderRadius);\n        border-color: var(--he-select-borderColor);\n        border-style: solid;\n        font-size: inherit;\n        width: 100%;\n        height: inherit;\n        margin: 0;\n        min-width: inherit;\n        outline: none;\n        text-align: left;\n        text-wrap: nowrap;\n        color: inherit;\n    }\n}\n\n');class n extends HTMLElement{static formAssociated=!0;static observedAttributes=["open","filter","disabled"];$popover;$popoverContent;$filter;$options;$button;$contButton;internals;_filterTimeout=0;_handleClickDocument;constructor(){super();let t=this.attachShadow({mode:"open"});this.internals=this.attachInternals(),this.$contButton=document.createElement("div"),this.$contButton.id="cont-button",t.append(this.$contButton),this.$popover=document.createElement("he-popover"),this.$popover.id="popover",this.$popover.dismiss="manual",this.$popover.$anchor=this.$contButton,this.$popoverContent=document.createElement("div"),this.$popoverContent.id="popover-content",this.$popoverContent.slot="content",this.$popover.append(this.$popoverContent),this.$filter=document.createElement("he-input"),this.$filter.id="filter",this.$filter.style.display="none",this.$filter.oninput=t=>this._handleChangeFilter.bind(this)(t),this.$button=document.createElement("button"),this.$button.id="inp",this.$button.onclick=()=>{this.open=!0},this.$contButton.append(this.$button),this.$options=document.createElement("div"),this.$options.id="cont-options",this.$popoverContent.append(this.$options),this.onkeydown=t=>this._handleKeydown(t),t.append(this.$popover),t.adoptedStyleSheets=[i]}set disabled(t){t?this.setAttribute("disabled",!0):this.removeAttribute("disabled")}get disabled(){return null!==this.getAttribute("disabled")}set filter(t){t?this.setAttribute("filter",!0):this.removeAttribute("filter")}get filter(){return null!==this.getAttribute("filter")}set name(t){t?this.setAttribute("name",t):this.removeAttribute("name")}get name(){return this.getAttribute("name")}set open(t){t?this.setAttribute("open",""):this.removeAttribute("open")}get open(){return null!==this.getAttribute("open")}set value(t){if(t){const e=this.$options.querySelector(`[value="${t}"]`);if(null==e)throw new Error("No option found with provided value!");this._select(e)}}get value(){return this.$selection?this.$selection.value:""}attributeChangedCallback(t,e,i){switch(t){case"open":null!=i?this._showPopover():this._hidePopover();break;case"filter":this.$filter.style.display=null==i||"false"===i?"none":"";break;case"disabled":null!=i?this.internals.setFormValue(null):this.internals.setFormValue(this.value)}}checkValidity(){return!0}connectedCallback(){if("inline"===this.getAttribute("filter"))this.$contButton.append(this.$filter),this.$filter.style.display="none";else this.$popoverContent.prepend(this.$filter);for(const t of this.querySelectorAll("option"))t.onclick=t=>this._handleClickOption.bind(this)(t),this.$options.append(t);this.select(0),this.hasAttribute("open")&&(this.open=!0)}formResetCallback(){let t=null;for(const e of this.$options.children)if(!e.hidden&&!e.disabled){t=e;break}if(null==t)return this.$button.innerHTML="",void this.internals.setFormValue(null);this._select(t)}getOptions(){return this.$options.children}hideOptions(t=null){let e=null;for(let i of this.$options.children)null==t||t.includes(i.value)?i.hidden=!0:(i.hidden=!1,null==e&&(e=i));return null==e?(this.$button.innerHTML="",this.internals.setFormValue(null)):this._select(e),this}nextOption(t=!1){let e=t?this.$highlight:this.$selection;if(!e)return void(t?this._highlight(this.$options.firstChild):this._select(this.$options.firstChild));let i=e.nextSibling;for(;;){if(e.isSameNode(i))return;if(null!=i){if(!i.hidden)break;i=i.nextSibling}else i=this.$options.firstChild}t?this._highlight(i):this._select(i)}prevOption(t=!1){let e=t?this.$highlight:this.$selection;if(!e)return void(t?this._highlight(this.$options.lastChild):this._select(this.$options.lastChild));let i=e.previousSibling;for(;;){if(e.isSameNode(i))return;if(null!=i){if(!i.hidden)break;i=i.previousSibling}else i=this.$options.lastChild}t?this._highlight(i):this._select(i)}replaceOptions(t,e=null){e=e??{},this.$options.innerHTML="";const i=this.value;let n=null;for(const o of t){let t=document.createElement("option");t.value=o,t.innerHTML=e[o]??o,t.onclick=t=>this._handleClickOption.bind(this)(t),this.$options.append(t),i===o&&(n=t)}return null!=n?this._select(n):this.select(0),this}showOptions(t=null){let e=null;for(let i of this.$options.children)(null==t||t.includes(i.value))&&(i.hidden=!1,null==e&&(e=i));return e=this.$selection??e,null!=e&&this._select(e),this}select(t){if(0===this.$options.children.length&&0===t)return;const e=this.$options.children[t];console.assert(null!=e,`No option with the given index ${t}!`),this._select(e)}toggle(){return this.$popover.togglePopover(),this}_handleChangeFilter(){window.clearTimeout(this._filterTimeout),this._filterTimeout=setTimeout((()=>{let t=this.$filter.value;t&&t.toLowerCase();let e=null;for(const i of this.$options.children)0===t.length||""!==i.value&&i.innerText.toLowerCase().includes(t)?(null==e&&(e=i),i.hidden=!1):i.hidden=!0;this._highlight(e)}),250)}_handleClickOption(t){this.open=!1;const e=t.currentTarget;this._select(e),this.dispatchEvent(new CustomEvent("change"))}_handleKeydown(t){switch(t.key){case"ArrowDown":t.preventDefault(),this.nextOption(!0);break;case"ArrowUp":t.preventDefault(),this.prevOption(!0);break;case"Enter":this.open?(t.preventDefault(),this._select(this.$highlight),this._hidePopover()):this.open=!0;break;case"Escape":t.preventDefault(),this._hidePopover()}}_hidePopover(){"inline"===this.getAttribute("filter")&&(this.$button.style.display="",this.$filter.style.display="none"),this.$filter.value="",this.$popover.hidePopover(),document.removeEventListener("click",this._handleClickDocument)}_highlight(t){this.$highlight&&this.$highlight.removeAttribute("highlighted"),null!=t&&(this.$highlight=t,this.$highlight.setAttribute("highlighted",""))}_showPopover(){"inline"===this.getAttribute("filter")&&(this.$button.style.display="none",this.$filter.style.display="");let i="bottom-left";t(this)<this.$popover.offsetHeight+20&&(i="top-left"),this._handleClickDocument=e([this.$popoverContent,this.$contButton],(()=>{this.open=!1})),this.$popover.setAttribute("position",this.getAttribute("position")??i),this.$filter.value="",this.showOptions(),this.$popover.style.visibility="hidden",this.$popover.showPopover();let n=this.$options.getBoundingClientRect().width,o=this.$contButton.getBoundingClientRect().width;o>n&&(this.$options.style.width=o+"px"),this.$popover.style.visibility="",this._highlight(this.$selection),this.$filter.focus()}_select(t){if(this.$selection&&this.$selection.removeAttribute("selected"),null==t)return this.$selection=null,this.internals.setFormValue(null),void(this.$filter.value="");this.$button.innerHTML=t.innerHTML,this.$selection=t,this.$selection.setAttribute("selected",""),this.disabled||this.internals.setFormValue(this.$selection.value)}}customElements.get("he-select")||customElements.define("he-select",n);export{n as HeliumSelect};
