import"./button-CHg57MzI.js";import"./input-IRIPAdDX.js";import"./dialog-DHp9mAmV.js";import"./select-CS53NvBW.js";import"./popover-BtSr2gHM.js";import"./utils-RA_86-hs.js";const e=new CSSStyleSheet;e.replaceSync("\r\n#he-form {\r\n    display: grid;\r\n    grid-template-columns: max-content 1fr;\r\n    gap: 0.5rem;\r\n    padding: 0.5rem;\r\n    margin-bottom: 0.5rem;\r\n    width: var(--he-form-dialog-width, 300px);\r\n    max-height: var(--he-form-dialog-max-height, 500px);\r\n    overflow: auto;\r\n}\r\n\r\n#footer-diag-edit {\r\n    display: flex;\r\n    gap: 0.5rem;\r\n    padding-right: 0.4rem;\r\n    padding-bottom: 0.4rem;\r\n}\r\n\r\n#he-form he-select, #he-form he-input {\r\n    width: 100%;\r\n}\r\n\r\n#he-form label {\r\n    display: flex;\r\n    align-items: center;\r\n}\r\n");class t extends Event{fetchArgs;constructor(e){super("he-form-dialog-submit",{detail:{fetchArgs:e}}),this.fetchArgs=e}}class i extends Event{response;constructor(e){super("he-form-dialog-response",{detail:{response:e}}),this.response=e}}class n extends HTMLElement{static observedAttributes=["open","title-text"];$dialog;$form;onsubmit;constructor(){super();let t=this.attachShadow({mode:"open"});t.adoptedStyleSheets=[e],this.$dialog=document.createElement("he-dialog"),this.$form=document.createElement("form"),this.$form.id="he-form",this.$form.slot="body",this.$dialog.append(this.$form);let i=document.createElement("div");i.id="footer-diag-edit",i.slot="footer",this.$dialog.append(i);let n=document.createElement("he-button");n.innerHTML="Speichern",n.id="btn-save",n.variant="primary",n.onclick=()=>this.submit.bind(this)(),i.append(n),t.append(this.$dialog)}connectedCallback(){this.addEventListener("he-dialog-show",(function(){this.show()})),this.addEventListener("he-dialog-close",(function(){this.close()}))}getValues(){let e={};for(const t of this.$form.querySelectorAll(".input"))e[t.name]=t.value;return e}submit(e,n){if(!this.checkValidity())return;const r=this.getValues();e=e??this.getAttribute("endpoint")??this.getAttribute("action"),(n=n??{}).method=n.method??this.getAttribute("method")??"POST",n.headers=n.headers??this.getAttribute("headers"),n.body=JSON.stringify(r);let o=new t(n);this.dispatchEvent(o),null!=this.onsubmit&&this.onsubmit(o),null!=e&&""!==e&&(this.$dialog.querySelector("#btn-save").loading=!0,fetch(e,n).then((e=>{this.$dialog.querySelector("#btn-save").loading=!1;const t=new i(e);this.dispatchEvent(t),null!=this.onresponse&&this.onresponse(t)})))}reset(){this.$form.reset()}setValues(e){for(const[t,i]of Object.entries(e)){const e=this.$form.querySelector(`[name="${t}"]`);e&&(e.value=i)}return this}renderRows(e){this.$form.innerHTML="",e.forEach(((e,t)=>{let i=`edit-${t}`,n=e.label;if(e.required&&(n+="*"),!e.hidden){let e=document.createElement("label");e.for=i,e.innerHTML=n,this.$form.append(e)}if(e.options&&Object.keys(e.options).length>0){let t=document.createElement("he-select");if(t.id=i,t.name=e.name,t.classList.add("input"),!e.required){let e=document.createElement("option");t.append(e)}e.hidden&&(t.style.display="none");for(const[i,n]of Object.entries(e.options)){const e=document.createElement("option");e.value=i,e.innerHTML=n,t.append(e)}this.$form.append(t)}else{let t=document.createElement("he-input");if(t.required=e.required,t.id=i,t.name=e.name,t.type=e.type??"text",t.classList.add("input"),e.pattern&&(t.pattern=e.pattern),e.attributes)for(const[i,n]of Object.entries(e.attributes))t.setAttribute(i,n);null!=e.placeholder&&(t.placeholder=e.placeholder),e.hidden&&(t.type="hidden"),this.$form.append(t)}}))}checkValidity(e){e=null==e?this.$form.querySelectorAll(".input"):[e];let t=!0;for(const i of e)i.checkValidity()||(t=!1);return t}attributeChangedCallback(e,t,i){this.$dialog.attributeChangedCallback(e,t,i)}show(e=!1){return e&&this.reset(),this.$dialog.show(empty),this}showModal(){return this.$dialog.showModal(),this}close(){return this.$dialog.close(),this}}customElements.define("he-form-dialog",n);export{n as HeliumFormDialog,i as HeliumFormDialogResponseEvent,t as HeliumFormDialogSubmitEvent};
