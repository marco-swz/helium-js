import{h as heSpaceBelow,a as hePositionRelative,b as heEnableBodyScroll}from"./utils-DoExkFin.js";const sheet=new CSSStyleSheet;sheet.replaceSync(':host {\n    height: fit-content;\n    width: fit-content;\n    font-size: 14px;\n    min-width: 60px;\n    display: inline-block;\n}\n\n:host([disabled]) {\n    pointer-events: none;\n    color: hsl(from var(--he-select-clr, black) h s calc(l + 50))\n}\n\n#inp {\n    position: relative;\n    background-color: var(--he-select-clr-bg, whitesmoke);\n    border: 1px solid lightgrey;\n    width: 100%;\n    height: inherit;\n    min-width: inherit;\n    padding: 0.3rem 0.4rem;\n    border-radius: 3px;\n    outline: none;\n    text-align: left;\n    padding-right: 25px;\n    text-wrap: nowrap;\n    color: inherit;\n}\n\n#inp:hover, #inp:focus {\n    cursor: pointer;\n    border-color: var(--he-select-clr-border-hover, grey);\n}\n\n#inp::after {\n    content: "▼";\n    position: absolute;\n    font-size: 10px;\n    width: fit-content;\n    height: fit-content;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    margin: auto 4px auto auto;\n}\n\n#popover {\n    inset: unset;\n    outline: none;\n    border: 1px solid grey;\n    border-radius: var(--he-select-border-radius, 3px);\n    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);\n    width: min-content;\n}\n\n#cont-options {\n    display: flex;\n    flex-direction: column;\n    background-color: var(--he-select-clr-bg, white);\n    max-height: 300px;\n    overflow: auto;\n    overscroll-behavior: contain;\n}\n\n#cont-options option {\n    padding: 5px 4px;\n    border-radius: 3px;\n}\n\n#cont-options option[selected] {\n    background-color: var(--he-select-clr-bg-hover, whitesmoke);\n}\n\n#cont-options option:hover:not(:disabled) {\n    background-color: var(--he-select-clr-bg-hover, whitesmoke);\n    cursor: pointer;\n}\n\n#filter {\n    --he-input-border-radius: 2px;\n    width: 100%;\n}\n\n');class HeliumSelect extends HTMLElement{static formAssociated=!0;static observedAttributes=["open","filter"];$popover;filter;options;internals;_filterTimeout=0;ignoreAttributes=!1;constructor(){super();let t=this.attachShadow({mode:"open"});this.internals=this.attachInternals(),this.input=document.createElement("button"),this.input.id="inp",this.input.setAttribute("popovertarget","popover"),this.filter=document.createElement("he-input"),this.filter.id="filter",this.filter.style.display="none",this.filter.onkeyup=()=>this._changedFilterCallback.bind(this)(),this.$popover=document.createElement("div"),this.$popover.id="popover",this.$popover.popover="",this.$popover.append(this.filter),this.$popover.addEventListener("beforetoggle",(t=>this._beforetoggledPopoverCallback.bind(this)(t))),this.$popover.addEventListener("toggle",(t=>this._toggledPopoverCallback.bind(this)(t))),t.append(this.$popover),t.append(this.input),t.adoptedStyleSheets=[sheet]}set disabled(t){t?this.setAttribute("disabled",!0):this.getAttribute("disabled")}get disabled(){return null!==this.getAttribute("disabled")}set filter(t){t?this.setAttribute("filter",!0):this.getAttribute("filter")}get filter(){return null!==this.getAttribute("filter")}set onchange(t){t?this.setAttribute("onchange",t):this.removeAttribute("onchange")}set open(t){t?this.$popover.showPopover():this.$popover.hidePopover()}get open(){return null!==this.getAttribute("open")}set value(t){if(t){const e=this.options.querySelector(`[value="${t}"]`);this._select(e)}}get value(){return this.selection?this.selection.value:""}attributeChangedCallback(t,e,i){if(!this.ignoreAttributes)switch(t){case"open":i?this.$popover.showPopover():this.$popover.hidePopover();break;case"filter":this.filter.style.display=null==i||"false"===i?"none":""}}connectedCallback(){this.options=document.createElement("div"),this.options.id="cont-options",this.options.slot="content";for(const t of this.querySelectorAll("option"))t.onclick=t=>this._clickedOptionCallback.bind(this)(t),this.options.append(t);this.input.innerHTML="‎",this.$popover.append(this.options),this.select(0)}select(t){const e=this.options.children[t];console.assert(null!=e,"No option with the given index!"),this._select(e)}toggle(){this.$popover.togglePopover()}_beforetoggledPopoverCallback(t){this.ignoreAttributes=!0,"open"===t.newState?(this.$popover.style.visibility="hidden",this.setAttribute("open",!0)):this.removeAttribute("open"),this.ignoreAttributes=!1}_changedFilterCallback(){window.clearTimeout(this._filterTimeout),this._filterTimeout=setTimeout((()=>{const t=this.filter.value.toLowerCase();for(const e of this.options.children)0===t.length||""!==e.value&&e.innerText.toLowerCase().includes(t)?e.style.display="":e.style.display="none"}),500)}_select(t){this.input.innerHTML=t.innerHTML,null!=this.selection&&this.selection.removeAttribute("selected"),this.selection=t,this.selection.setAttribute("selected",""),this.internals.setFormValue(this.selection.value)}_toggledPopoverCallback(t){if("open"===t.newState){this.internals.states.add("open");let t="bottom-left";heSpaceBelow(this)<this.$popover.offsetHeight+20&&(t="top-left");const e=this.getAttribute("position")??t;hePositionRelative(this.$popover,this.input,e,3);const i=7;this.$popover.offsetWidth<this.input.offsetWidth-i&&(this.$popover.style.width=this.input.offsetWidth-7+"px"),this.$popover.style.visibility="",this.filter.focus()}else{this.internals.states.delete("open"),this.filter.value="";for(const t of this.options.children)t.style.display="";heEnableBodyScroll()}}_clickedOptionCallback(e){this.open=!1;const target=e.currentTarget;this._select(target);const onchange=this.getAttribute("onchange");eval(onchange)}}customElements.get("he-select")||customElements.define("he-select",HeliumSelect);export{HeliumSelect};
